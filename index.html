<!doctype html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="description" content="Amazing Luogu 国际" />
	<meta http-equiv="Content-Security-Policy"
		content="default-src 'self'; script-src 'self' 'unsafe-inline' data: https://cdn.jsdmirror.cn https://static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' data: https://cdn.jsdmirror.cn; img-src 'self' data: https:; font-src 'self' data: https://cdn.jsdmirror.cn; connect-src 'self' data: https://luogu-api.amlg.top https://cdn.jsdmirror.cn; worker-src 'self'" />
	<link rel="icon" type="image/svg+xml" href="./icon.png" />
	<title>Amazing Luogu</title>
	<link rel="stylesheet" href="/public/fontawesome.all.min.css" />
	<link rel="preload" href="/public/lwsw.min.css" as="style"
		crossorigin="anonymous" onload="this.rel='stylesheet'" />
	<link rel="preload"
		href="/public/aol.min.css" as="style"
		crossorigin="anonymous" onload="this.rel='stylesheet'" />
	<link rel="preload"
		href="/public/gd.min.css" as="style"
		crossorigin="anonymous" onload="this.rel='stylesheet'" />
	<link rel="stylesheet"
		href="/public/md.css" />
	<link rel="stylesheet"
		href="/public/fw.css" />
	<link rel="preload" href="/public/kt.min.css" as="style"
		crossorigin="anonymous" onload="this.rel='stylesheet'" />
	<link rel="stylesheet" href="/public/am.min.css" />
	<style>
		.markdown-body {
			font-size: 16px;
			line-height: 1.6;
			color: var(--text-color);
		}

		#goBtn {
			position: absolute;
			right: 68px;
			top: 3px;
			bottom: 4px;
			padding: 0 16px;
			background: var(--primary-color);
			color: white;
			border: none;
			border-radius: var(--border-radius-sm);
			cursor: pointer;
			font-weight: 500;
			transition: background 0.2s;
		}

		#urlInput {
			width: 73%;
			padding: 12px 16px;
			font-size: 1rem;
			border: 1px solid var(--border-color);
			border-radius: var(--border-radius-sm);
			background: var(--card-bg);
			color: var(--text-color);
			box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
			transition: border-color 0.2s;
		}

		.markdown-body .katex-display {
			overflow-x: auto;
			overflow-y: hidden;
		}

		.katex-display .katex {
			display: block;
		}

		.notice {
			margin-block-start: 1em;
			margin-block-end: 1em;
			margin-inline-start: 40px;
			margin-inline-end: 40px;
			unicode-bidi: isolate;
			padding: 10px 20px;
			margin: 0 0 20px;
			border-left: 5px solid #eee;
			margin-top: 30px;
			border-radius: 15px;
			background-color: var(--card-bg);
			text-align: left;
		}

		.notice h2 {
			margin-top: 0px;
		}

		.important-notice {
			border-left: 5px #f85149 solid;
		}

		.important-notice i {
			color: #f85149;
		}

		.flowing-light {
			animation-delay: 0s;
			color: #444;
			text-shadow: 0 0 0 #444;
			animation: flowing-light 1s ease-in-out infinite alternate;
			animation-delay: 0.1s;
		}

		@keyframes flowing-light {
			to {
				text-shadow: 0 0 1px #fff,
					0 0 1px #fff,
					0 0 3px #fff,
					0 0 6px #126fcc,
					0 0 7px #126fcc,
					0 0 11px #126fcc;
				color: #aaaaaa;
			}
		}

		.page-layout {
			display: flex;
			gap: 24px;
			max-width: 1400px;
			margin: 0 auto;
		}

		.main-content {
			flex: 1;
			min-width: 0;
		}

		.toc-sidebar {
			width: 240px;
			flex-shrink: 0;
			position: sticky;
			top: 80px;
			align-self: flex-start;
			background: var(--card-bg);
			border-radius: var(--border-radius-sm);
			padding: 16px;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
			max-height: calc(100vh - 100px);
			overflow-y: auto;
		}

		.toc-sidebar h4 {
			margin: 0 0 12px 0;
			font-size: 1rem;
			color: var(--text-color);
			border-bottom: 1px solid var(--border-color);
			padding-bottom: 8px;
		}

		.toc-content a {
			display: block;
			padding: 4px 0;
			color: var(--text-light);
			text-decoration: none;
			font-size: 0.9rem;
			transition: color 0.2s;
		}

		.toc-content a:hover {
			color: var(--primary-color);
		}

		.toc-content .h2 {
			padding-left: 12px;
		}

		.toc-content .h3 {
			padding-left: 24px;
		}

		.toc-content .h4 {
			padding-left: 36px;
		}

		.toc-content .h5 {
			padding-left: 48px;
		}

		.toc-content .h6 {
			padding-left: 60px;
		}

		.article-header {
			display: flex;
			flex-wrap: wrap;
			gap: 8px;
			align-items: center;
			margin-bottom: 16px;
			padding-bottom: 12px;
			border-bottom: 1px solid var(--border-color);
		}

		.action-btn {
			padding: 6px 12px;
			background: var(--card-bg);
			border: 1px solid var(--border-color);
			border-radius: var(--border-radius-sm);
			color: var(--text-color);
			cursor: pointer;
			font-size: 0.9rem;
			transition: all 0.2s;
			display: inline-flex;
			align-items: center;
			gap: 6px;
		}

		.action-btn:hover {
			background: var(--primary-color);
			border-color: var(--primary-color);
			color: #fff;
		}

		.save-time {
			margin-left: auto;
			font-size: 0.85rem;
			color: var(--text-light);
		}

		@media (max-width: 1100px) {
			.page-layout {
				flex-direction: column;
			}

			.toc-sidebar {
				position: static;
				max-height: 300px;
			}

			.save-time {
				margin-left: 0;
				text-align: right;
			}
		}

		.markdown-body h1,
		.markdown-body h2,
		.markdown-body h3,
		.markdown-body h4,
		.markdown-body h5,
		.markdown-body h6 {
			scroll-margin-top: 80px;
			scroll-padding-top: 80px;
		}

		.global-loading {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: var(--bg-color);
			display: flex;
			align-items: center;
			justify-content: center;
			z-index: 9999;
			transition: opacity 0.3s, visibility 0.3s;
		}

		.global-loading.hidden {
			opacity: 0;
			visibility: hidden;
			pointer-events: none;
		}

		.loading-spinner {
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 16px;
			color: var(--text-color);
		}

		.loading-spinner i {
			font-size: 2.5rem;
			color: var(--primary-color);
		}

		.loading-spinner span {
			font-size: 1rem;
			color: var(--text-light);
		}

		.markdown-body .loading {
			display: flex;
			align-items: center;
			justify-content: center;
			padding: 40px;
			color: var(--text-light);
			gap: 12px;
		}

		.markdown-body .loading i {
			color: var(--primary-color);
			animation: spin 1s linear infinite;
		}

		@keyframes spin {
			to {
				transform: rotate(360deg);
			}
		}

		#not-found-page {
			animation: fadeIn 0.3s ease-out;
		}

		@keyframes fadeIn {
			from {
				opacity: 0;
				transform: translateY(10px);
			}

			to {
				opacity: 1;
				transform: translateY(0);
			}
		}

		button {
			font-family: LXGW Wenkai Screen;
		}

		@media (prefers-color-scheme: dark) {

			.hljs,
			.code-container,
			pre {
				background: #282c34 !important;
				color: #abb2bf !important;
			}

			.markdown-body code {
				background-color: #282c34;
				color: #abb2bf;
			}

			.markdown-body blockquote {
				color: #999;
				border-left-color: #444;
			}

			.markdown-body th,
			.markdown-body td {
				border-color: #444;
			}
		}

		.user-profile {
			max-width: 900px;
			margin: 0 auto;
			display: flex;
			flex-direction: column;
			gap: 16px;
		}

		.user-header {
			position: relative;
			overflow: hidden;
		}

		.user-info {
			display: flex;
			align-items: center;
			gap: 16px;
			padding: 80px 16px 16px 16px;
			margin-top: 0px;
			background-size: cover;
			background-position: center;
		}

		.user-avatar {
			width: 80px;
			height: 80px;
			border-radius: 50%;
			border: 3px solid var(--card-bg);
			object-fit: cover;
		}

		.user-name {
			margin: 0;
			font-size: 1.4rem;
		}

		.user-name.orange {
			color: #f39c11;
		}

		.user-name.blue {
			color: #3498db;
		}

		.user-name.green {
			color: #5eb95e;
		}

		.user-name.purple {
			color: #9d3dcf;
		}

		.user-name.red {
			color: #e74c3c;
		}

		.user-name.cheater {
			color: rgb(173, 139, 0);
		}

		.user-name.grey {
			color: rgb(191, 191, 191);
		}

		.user-slogan {
			margin: 4px 0 0;
			color: #fff;
			font-size: 0.9rem;
		}

		.user-badges {
			display: flex;
			gap: 8px;
			margin-top: 8px;
		}

		.badge {
			padding: 2px 8px;
			border-radius: 12px;
			font-size: 0.8rem;
			background: var(--border-color);
		}

		.stat-grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
			gap: 12px;
			padding: 16px;
		}

		.stat-item {
			text-align: center;
		}

		.stat-value {
			display: block;
			font-size: 1.5rem;
			font-weight: 600;
			color: var(--primary-color);
		}

		.stat-label {
			font-size: 0.85rem;
			color: var(--text-light);
		}

		.prize-list {
			display: flex;
			flex-wrap: wrap;
			gap: 8px;
			padding: 16px;
		}

		.prize-item {
			display: flex;
			align-items: center;
			gap: 8px;
			padding: 6px 12px;
			background: var(--border-color);
			border-radius: var(--border-radius-sm);
			font-size: 0.9rem;
		}

		.prize-year {
			font-weight: 600;
		}

		.prize-contest {
			color: var(--text-light);
		}

		.prize-name {
			color: var(--primary-color);
		}

		.elo-table table {
			width: 100%;
			border-collapse: collapse;
		}

		.elo-table th,
		.elo-table td {
			padding: 8px 12px;
			border-bottom: 1px solid var(--border-color);
			text-align: left;
		}

		.diff-up {
			color: #52c41a;
		}

		.diff-down {
			color: #f5222d;
		}

		.activity-grid {
			display: grid;
			grid-template-columns: repeat(7, 1fr);
			gap: 4px;
			padding: 0 16px 16px;
		}

		.activity-day {
			aspect-ratio: 1;
			background: var(--border-color);
			border-radius: 4px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 0.7rem;
			cursor: pointer;
			transition: transform 0.1s;
		}

		.activity-day:hover {
			transform: scale(1.1);
			background: var(--primary-color);
			color: #fff;
		}

		.card {
			background: var(--card-bg);
			border-radius: var(--border-radius-sm);
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
		}

		.card h3 {
			margin: 0;
			padding: 12px 16px;
			border-bottom: 1px solid var(--border-color);
			font-size: 1.1rem;
		}

		.markdown-body {
			padding: 16px;
		}

		@media (max-width: 768px) {
			.user-info {
				flex-direction: column;
				text-align: center;
			}

			.activity-grid {
				grid-template-columns: repeat(7, 1fr);
				gap: 2px;
			}
		}

		/* 回复区域样式 */
		.replies-section {
			margin-top: 24px;
		}

		.replies-section h3 {
			margin: 0 0 16px;
			padding: 12px 16px;
			border-bottom: 1px solid var(--border-color);
			font-size: 1.1rem;
			display: flex;
			align-items: center;
			gap: 8px;
		}

		.text-light {
			color: var(--text-light);
			font-size: 0.9rem;
			font-weight: normal;
		}

		.text-error {
			color: #f5222d;
			text-align: center;
			padding: 20px;
		}

		.replies-list {
			display: flex;
			flex-direction: column;
			gap: 12px;
			padding: 0 16px 16px;
		}

		.reply-item {
			padding: 12px;
			background: var(--card-bg);
			border-radius: var(--border-radius-sm);
			border: 1px solid var(--border-color);
			transition: border-color 0.2s;
		}

		.reply-item:hover {
			border-color: var(--primary-color);
		}

		.reply-header {
			display: flex;
			align-items: center;
			gap: 10px;
			margin-bottom: 8px;
		}

		.reply-avatar {
			width: 32px;
			height: 32px;
			border-radius: 50%;
			object-fit: cover;
			flex-shrink: 0;
		}

		.reply-meta {
			display: flex;
			align-items: center;
			gap: 8px;
			flex-wrap: wrap;
			font-size: 0.9rem;
		}

		.reply-author {
			font-weight: 500;
		}

		.reply-author.orange {
			color: #fa8c16;
		}

		.reply-author.blue {
			color: #1890ff;
		}

		.reply-author.green {
			color: #52c41a;
		}

		.reply-author.red {
			color: #f5222d;
		}

		.reply-time {
			color: var(--text-light);
			font-size: 0.85rem;
		}

		.badge {
			padding: 1px 6px;
			border-radius: 10px;
			font-size: 0.75rem;
			background: var(--border-color);
			color: var(--text-color);
		}

		.badge.ccf-level-1 {
			background: #e6f7ff;
			color: #1890ff;
		}

		.badge.ccf-level-2 {
			background: #f6ffed;
			color: #52c41a;
		}

		.badge.ccf-level-3 {
			background: #fff7e6;
			color: #fa8c16;
		}

		.badge.ccf-level-4 {
			background: #fff1f0;
			color: #f5222d;
		}

		.badge.ccf-level-5 {
			background: #f9f0ff;
			color: #722ed1;
		}

		.badge.ccf-level-6 {
			background: #fff0f6;
			color: #eb2f96;
		}

		.reply-content {
			padding-left: 42px;
			font-size: 0.95rem;
			line-height: 1.6;
		}

		.reply-content .markdown-body {
			padding: 0;
			font-size: inherit;
		}

		.reply-content .markdown-body p {
			margin: 0;
		}

		.reply-content .markdown-body img {
			max-width: 100%;
			max-height: 200px;
			border-radius: var(--border-radius-sm);
			cursor: pointer;
			transition: transform 0.2s;
		}

		.reply-content .markdown-body img:hover {
			transform: scale(1.02);
		}

		/* 加载更多按钮 */
		#load-more-replies {
			width: fit-content;
		}

		/* 响应式适配 */
		@media (max-width: 768px) {
			.reply-content {
				padding-left: 0;
				padding-top: 8px;
			}

			.reply-header {
				flex-wrap: wrap;
			}
		}

		/* 暗色模式适配 */
		@media (prefers-color-scheme: dark) {
			.reply-item {
				background: var(--card-bg);
				border-color: #444;
			}

			.badge {
				background: #333;
			}
		}
	</style>
</head>

<body>
	<div id="global-loading" class="global-loading">
		<div class="loading-spinner">
			<i class="fa-solid fa-spinner fa-spin"></i>
			<span>加载中...</span>
		</div>
	</div>
	<div id="app">
		<aside class="sidebar" id="sidebar">
			<nav class="nav-menu">
				<a class="nav-logo-item" data-page="none">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" class="nav-icon" height="24" viewBox="0 0 24 24">
						<path fill="currentColor"
							d="M12.424 0c-.435-.005-.964.138-1.569.65c-.967.817-2.554 3.235-3.56 4.38s-2.002 1.65-2.48 2.493c-.477.844-.824 1.598-.385 2.568s2.308 2.592 3.018 3.247s.724.566 1.24.68c.517.113 1.38.188 1.857 0c.478-.19.993-.63 1.006-1.133s-.515-1.409-.928-1.887c-.413-.479-1.213-.769-1.549-.983s-.373-.076-.463-.303s-.413-.59-.078-1.056c.336-.466 1.38-1.033 2.09-1.738s1.625-1.61 2.167-2.492s1.06-2.064 1.085-2.794C13.901.902 13.603.285 13.1.12a2.2 2.2 0 0 0-.676-.12m-.397 6.936c-.243.008-.443.037-.566.097c-.492.24-.48.997-.151 1.515s1.618 1.223 2.124 1.59c.505.366.883.292.908.607c.026.316.102.315-.757 1.287c-.86.973-3.222 3.371-4.397 4.546c-1.175 1.174-1.77 1.503-2.654 2.5S4.259 21.78 3.88 22.563s-.15.997.38 1.212c.531.214 2.11.34 2.804.075c.695-.265.822-1.034 1.365-1.666c.543-.63.721-.859 1.896-2.122c.472-.507 1.242-1.32 1.998-2.118c.048.151.126.324.243.525c.423.727 1.922 2.219 2.537 3.009s.77 1.33 1.154 1.73c.384.402.55.564 1.152.677c.602.112 1.998.188 2.459 0c.461-.189.552-.576.308-1.127c-.243-.552-1.346-1.555-1.768-2.182c-.423-.627-1.243-2.095-1.845-2.71s-1.025-.776-1.768-.977c-.43-.115-.982-.11-1.444-.034c.769-.811 1.564-1.647 2.129-2.246c1.415-1.503 2.88-2.614 3.335-3.56c.455-.948-.214-1.492-.606-2.123c-.391-.631-1.124-1.363-1.743-1.666c-.62-.303-1.151-.1-1.972-.151c-.616-.038-1.737-.197-2.467-.173" />
					</svg>
					<span class="nav-text">Amazing Luogu 国际</span>
				</a>
				<a href="/" class="nav-item" data-page="home">
					<i class="fa-solid fa-house-chimney-user nav-icon"></i>
					<span class="nav-text">首页</span>
				</a>
				<a href="/a/y81xoxgi" class="nav-item" data-page="articles">
					<i class="fa-regular fa-newspaper nav-icon"></i>
					<span class="nav-text">文章</span>
				</a>
				<a href="/p/wnvx31ss" class="nav-item" data-page="clipboard">
					<i class="fa-solid fa-clipboard-list nav-icon"></i>
					<span class="nav-text">剪贴板</span>
				</a>
			</nav>
		</aside>
		<div class="sidebar-overlay" id="sidebarOverlay"></div>
		<div class="main-container">
			<header class="topbar">
				<div class="topbar-left">
					<button class="menu-toggle" id="menuToggle" aria-label="切换菜单">
						<i class="fas fa-bars"></i>
					</button>
					<nav class="breadcrumb" id="breadcrumb"></nav>
				</div>
				<div class="logo">
					<img src="https://cdn.luogu.com.cn/upload/image_hosting/7x00uufg.png" referrerpolicy="no-referrer"
						crossorigin="anonymous" alt="Logo" class="logo-img">
				</div>
			</header>
			<main class="content" id="not-found-page" style="display: none;">
				<div style="text-align: center; padding: 80px 20px;">
					<i class="fa-solid fa-ghost"
						style="font-size: 4rem; color: var(--text-light); margin-bottom: 24px;"></i>
					<h1 style="font-size: 2rem; color: var(--text-color); margin-bottom: 16px;">404 - 页面未找到</h1>
					<p style="color: var(--text-light); margin-bottom: 32px;">抱歉，您访问的页面不存在或已被移除。</p>
					<a href="/" class="action-btn" style="text-decoration: none;">
						<i class="fa-solid fa-house"></i> 返回首页
					</a>
				</div>
			</main>
			<main class="content" id="user-page" style="display: none;"></main>
			<main class="content" id="home-page">
				<div style="text-align: center; max-width: 600px; margin: 0 auto;">
					<div
						style="display: flex; align-items: center; justify-content: center; gap: 16px; margin-bottom: 32px;">
						<h1 style="font-size: 2.5rem; font-weight: 700; color: var(--secondary-color); margin: 0;">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width: 31.57px">
								<path fill="currentColor"
									d="M12.424 0c-.435-.005-.964.138-1.569.65c-.967.817-2.554 3.235-3.56 4.38s-2.002 1.65-2.48 2.493c-.477.844-.824 1.598-.385 2.568s2.308 2.592 3.018 3.247s.724.566 1.24.68c.517.113 1.38.188 1.857 0c.478-.19.993-.63 1.006-1.133s-.515-1.409-.928-1.887c-.413-.479-1.213-.769-1.549-.983s-.373-.076-.463-.303s-.413-.59-.078-1.056c.336-.466 1.38-1.033 2.09-1.738s1.625-1.61 2.167-2.492s1.06-2.064 1.085-2.794C13.901.902 13.603.285 13.1.12a2.2 2.2 0 0 0-.676-.12m-.397 6.936c-.243.008-.443.037-.566.097c-.492.24-.48.997-.151 1.515s1.618 1.223 2.124 1.59c.505.366.883.292.908.607c.026.316.102.315-.757 1.287c-.86.973-3.222 3.371-4.397 4.546c-1.175 1.174-1.77 1.503-2.654 2.5S4.259 21.78 3.88 22.563s-.15.997.38 1.212c.531.214 2.11.34 2.804.075c.695-.265.822-1.034 1.365-1.666c.543-.63.721-.859 1.896-2.122c.472-.507 1.242-1.32 1.998-2.118c.048.151.126.324.243.525c.423.727 1.922 2.219 2.537 3.009s.77 1.33 1.154 1.73c.384.402.55.564 1.152.677c.602.112 1.998.188 2.459 0c.461-.189.552-.576.308-1.127c-.243-.552-1.346-1.555-1.768-2.182c-.423-.627-1.243-2.095-1.845-2.71s-1.025-.776-1.768-.977c-.43-.115-.982-.11-1.444-.034c.769-.811 1.564-1.647 2.129-2.246c1.415-1.503 2.88-2.614 3.335-3.56c.455-.948-.214-1.492-.606-2.123c-.391-.631-1.124-1.363-1.743-1.666c-.62-.303-1.151-.1-1.972-.151c-.616-.038-1.737-.197-2.467-.173" />
							</svg> Amazing Luogu 国际
						</h1>
						<hr>
					</div>
					<p style="color: var(--text-light);">请输入任意洛谷文章、剪贴板或用户链接，自动跳转到国际版</p>
					<div
						style="position: relative; align-items: center; flex-direction: row; flex-wrap: nowrap; justify-content: center;">
						<input type="text" id="urlInput" placeholder="paste/wnvx31ss" />
						<button id="goBtn"><i class="fa-solid fa-bolt flowing-light"></i></button>
					</div>
				</div>
			</main>
			<main class="content" id="article-page" style="display: none;">
				<div class="page-layout">
					<div class="main-content">
						<div class="article-header">
							<!-- <button id="backBtn" class="action-btn"><i class="fa-solid fa-arrow-left"></i> 返回</button> -->
							<button id="refreshBtn" class="action-btn"><i class="fa-solid fa-rotate"></i> 更新</button>
							<button id="copyRawBtn" class="action-btn"><i class="fa-solid fa-copy"></i> 复制原文</button>
							<button id="jumpOriginalBtn" class="action-btn"><i class="fa-solid fa-external-link"></i>
								跳转原文</button>
							<span id="saveTime" class="save-time"></span>
						</div>
						<div class="markdown-body" id="article-content">
							<div class="loading">加载中...</div>
						</div>
						<div class="replies-section card" id="replies-section" style="display: none; padding-bottom: 12px;">
							<h3><i class="fa-regular fa-comment-dots"></i> 回复列表 <span id="replies-count" class="text-light"></span></h3>
							<div id="replies-list" class="replies-list">
								<div class="loading"><i class="fa-solid fa-spinner fa-spin"></i> 加载回复中...</div>
							</div>
							<button id="load-more-replies" class="action-btn" style="display: none; margin: 12px auto;">
								<i class="fa-solid fa-plus"></i> 加载更多
							</button>
						</div>
					</div>
					<aside class="toc-sidebar" id="toc-sidebar">
						<h4>目录</h4>
						<div id="toc-content" class="toc-content"><a href="#" class="h1">无标题</a></div>
					</aside>
				</div>
			</main>
			<main class="content" id="paste-page" style="display: none;">
				<div class="page-layout">
					<div class="main-content">
						<div class="article-header">
							<button id="refreshBtn-2" class="action-btn"><i class="fa-solid fa-rotate"></i> 更新</button>
							<button id="copyRawBtn-2" class="action-btn"><i class="fa-solid fa-copy"></i> 复制原文</button>
							<button id="jumpOriginalBtn-2" class="action-btn"><i class="fa-solid fa-external-link"></i>
								跳转原文</button>
							<span id="saveTime-2" class="save-time"></span>
						</div>
						<div class="markdown-body" id="paste-content">
							<div class="loading">加载中...</div>
						</div>
					</div>
					<aside class="toc-sidebar" id="toc-sidebar">
						<h4>目录</h4>
						<div id="toc-content-2" class="toc-content"><a href="#" class="h1">无标题</a></div>
					</aside>
				</div>
			</main>
		</div>
	</div>
	<script src="/public/fw.js"></script>
	<script src="/public/md.min.js"></script>
	<script src="/public/k.min.js"></script>
	<script src="/public/ar.min.js"></script>
	<script src="/public/hl.min.js"></script>
	<script>
		let currentRawContent = '';
		let currentType = '';
		let currentId = '';
		const customExtensions = [
			{
				name: 'alignBlock',
				level: 'block',
				start(src) { return src.match(/^:::\s*align\s*\{([^}]+)\}/)?.index; },
				tokenizer(src, tokens) {
					const match = src.match(/^:::\s*align\s*\{([^}]+)\}([\s\S]*?)\n:::/);
					if (match) {
						return {
							type: 'alignBlock',
							raw: match[0],
							align: match[1].trim(),
							content: match[2].trim()
						};
					}
				},
				renderer(token) {
					return `<div class="align-${token.align}">${marked.parse(token.content)}</div>`;
				}
			},
			{
				name: 'epigraph',
				level: 'block',
				start(src) { return src.match(/^:::\s*epigraph(\[([^\]]+)\])?\s*:::/)?.index; },
				tokenizer(src, tokens) {
					const match = src.match(/^:::\s*epigraph(\[([^\]]+)\])?\s*([\s\S]*?)\s*:::/);
					if (match) {
						return {
							type: 'epigraph',
							raw: match[0],
							author: match[2] || '',
							content: match[3].trim()
						};
					}
				},
				renderer(token) {
					const authorPart = `<p>${token.author ? token.author : 'unknown author'}</p>`;
					return `<div class="epigraph">${marked.parse(token.content)}${authorPart}</div>`;
				}
			},
			{
				name: 'foldable',
				level: 'block',
				start(src) { return src.match(/^:{3,}/)?.index; },
				tokenizer(src, tokens) {
					const match = src.match(/^(:{3,})\s*(\w+)?(\[([^\]]+)\])?(\s*\{([^}]+)\})?\s*([\s\S]*?)\s*\1/);
					if (match && (match[2] === 'info' || match[2] === 'warning' || match[2] === 'success' || match[2] === 'error' || match[2] === 'bug' || match[2] === 'flask')) {
						return {
							type: 'foldable',
							raw: match[0],
							foldType: match[2] || 'info',
							title: match[4] || '',
							options: match[6] || '',
							content: match[7].trim()
						};
					}
				},
				renderer(token) {
					const isOpen = token.options.includes('open');
					return `
						<details class="foldable ${token.foldType}" ${isOpen ? 'open' : ''}>
							<summary>${token.title || '点击展开'}</summary>
							${marked.parse(token.content)}
						</details>
					`;
				}
			}
		];
		marked.use({ extensions: customExtensions });
		function escapeHtml(str) {
			return str
				.replace(/&/g, '&amp;')
				.replace(/</g, '&lt;')
				.replace(/>/g, '&gt;')
				.replace(/"/g, '&quot;')
				.replace(/'/g, '&#039;');
		}
		const renderer = new marked.Renderer();
		renderer.code = function (code, language) {
			const lang = language || 'plaintext';
			let highlighted = code;
			if (language && hljs.getLanguage(lang)) {
				try {
					highlighted = hljs.highlight(code, { language: lang, ignoreIllegals: true }).value;
				} catch (e) { }
			}
			return `<div class="code-container"><pre><code class="language-${lang}">${highlighted}</code></pre></div>`;
		};
		marked.setOptions({
			breaks: false,
			gfm: true,
			mangle: false,
			headerIds: false,
			renderer: renderer,
		});
		function renderMarkdown(text) {
			text = escapeHtml(text);
			// text = text.replace(/(^|\s)\$\$\s*\n([\s\S]*?)\n\s*\$\$(?=\s|$)/gm, '$1\n$$$$$2$$$$\n');
			// text = text.replace(
            //     /(^|[^\n])\n(\|.*\|)\n(\|.*[-:].*\|)/g,
            //     '$1\n\n$2\n$3'
            // );
			console.log(text);
			const tmp = document.createElement('div');
			tmp.innerHTML = sanitizeHTML(marked.parse(text));
			const images = tmp.querySelectorAll('img');
			images.forEach(img => {
				img.setAttribute('referrerpolicy', 'no-referrer');
				img.setAttribute('crossorigin', 'anonymous');
			});
			renderMathInElement(tmp, {
				delimiters: [
					{ left: '$$', right: '$$', display: true },
					{ left: '$', right: '$', display: false }
				],
				strict: false,
				escape: false,
				preProcess: (math) => {
					let processed = math.replace(/\\(\r?\n)/g, '\\\\$1');
					return processed;
				}
			});
			return tmp.innerHTML;
		}
		function formatRelativeTime(timestamp) {
			if (!timestamp) return '';
			const now = Date.now();
			const time = timestamp * 1000;
			const diff = now - time;
			const seconds = Math.floor(diff / 1000);
			const minutes = Math.floor(seconds / 60);
			const hours = Math.floor(minutes / 60);
			const days = Math.floor(hours / 24);
			if (seconds < 60) return '刚刚';
			if (minutes < 60) return `${minutes}分钟前`;
			if (hours < 24) return `${hours}小时前`;
			if (days < 7) return `${days}天前`;
			return new Date(time).toLocaleDateString('zh-CN', {
				month: '2-digit',
				day: '2-digit'
			});
		}
		function sanitizeHTML(html) {
			const parser = new DOMParser();
			const doc = parser.parseFromString(html, 'text/html');
			const dangerousTags = ['script', 'link', 'meta', 'object', 'embed', 'style']; // 我们保留 iframe
			dangerousTags.forEach(tag => {
				doc.querySelectorAll(tag).forEach(el => el.remove());
			});
			doc.querySelectorAll('*').forEach(el => {
				[...el.attributes].forEach(attr => {
					if (attr.name.startsWith('on') || attr.name.toLowerCase() === 'style') {
						el.removeAttribute(attr.name);
					}
					if (attr.value && typeof attr.value === 'string' && attr.value.trim().toLowerCase().startsWith('javascript:')) {
						el.removeAttribute(attr.name);
					}
				});
			});
			doc.querySelectorAll('table').forEach(table => {
				const rows = table.querySelectorAll('tr');
				if (rows.length > 0 && !table.querySelector('tbody')) {
					const tbody = doc.createElement('tbody');
					rows.forEach(tr => tbody.appendChild(tr));
					table.appendChild(tbody);
				}
			});
			return doc.body.innerHTML;
		}
		function updateHighlightTheme() {
			const isDark = document.documentElement.getAttribute('data-theme') === 'dark' ||
				document.body.classList.contains('dark-mode') ||
				window.matchMedia('(prefers-color-scheme: dark)').matches;
			const lightTheme = document.querySelector('link[href*="atom-one-light"]');
			const darkTheme = document.getElementById('hljs-dark-theme');
			if (isDark) {
				if (lightTheme) lightTheme.disabled = true;
				if (darkTheme) darkTheme.disabled = false;
			} else {
				if (lightTheme) lightTheme.disabled = false;
				if (darkTheme) darkTheme.disabled = true;
			}
			document.querySelectorAll('pre code').forEach((block) => {
				hljs.highlightElement(block);
			});
		}
		function showPage(pageKey) {
			const pages = ['home', 'article', 'paste', 'not-found'];
			pages.forEach(k => {
				const el = document.getElementById(`${k}-page`);
				if (el) el.style.display = 'none';
			});
			const target = document.getElementById(`${pageKey}-page`);
			if (target) {
				target.style.display = 'block';
				if (pageKey === 'article' || pageKey === 'paste') {
					const contentEl = document.getElementById(`${pageKey}-content`);
					if (contentEl) contentEl.innerHTML = '<div class="loading"><i class="fa-solid fa-spinner"></i><span>加载中...</span></div>';
				}
			}
			document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
			let activePage = pageKey === 'home' ? 'home' : pageKey === 'article' ? 'articles' : pageKey === 'paste' ? 'clipboard' : null;
			if (activePage) {
				const activeEl = document.querySelector(`.nav-item[data-page="${activePage}"]`);
				if (activeEl) activeEl.classList.add('active');
			}
		}
		let currentArticleReplies = {
			articleId: null,
			lastId: null,
			hasMore: true,
			loading: false,
			count: 0,
			high: 0
		};
		async function loadArticleReplies(articleId, lastId = null, limit = 20, append = false) {
			if (currentArticleReplies.loading || !currentArticleReplies.hasMore) return;
			currentArticleReplies.loading = true;
			const repliesList = document.getElementById('replies-list');
			const loadMoreBtn = document.getElementById('load-more-replies');
			if (!append) {
				repliesList.innerHTML = '<div class="loading"><i class="fa-solid fa-spinner fa-spin"></i> 加载回复中...</div>';
				loadMoreBtn.style.display = 'none';
			}
			try {
				let url = `https://luogu-api.amlg.top/article/${articleId}/replies?r=1`;
				if (lastId) url += `&after=${lastId}`;
				const res = await fetch(url, { cache: 'no-store' });
				const data = await res.json();
				if (!data.success || !data.data?.replySlice) {
					throw new Error('加载失败');
				}
				const replies = data.data.replySlice;
				currentArticleReplies.lastId = replies.length > 0 ? replies[replies.length - 1].id : null;
				currentArticleReplies.hasMore = (currentArticleReplies.high ? currentArticleReplies.high : 0) < currentArticleReplies.count;
				currentArticleReplies.high += replies.length;
				console.log(currentArticleReplies.high);
				renderReplies(replies, append);
				const countEl = document.getElementById('replies-count');
				if (countEl) {
					const currentCount = repliesList.querySelectorAll('.reply-item').length;
					countEl.textContent = `(${currentCount}${currentArticleReplies.hasMore ? '+' : ''})`;
				}
				loadMoreBtn.style.display = currentArticleReplies.hasMore ? 'flex' : 'none';
			} catch (e) {
				console.error('加载回复失败:', e);
				if (!append) {
					repliesList.innerHTML = '<p class="text-error">回复加载失败，请稍后重试</p>';
				}
			} finally {
				currentArticleReplies.loading = false;
			}
		}
		function renderReplies(replies, append = false) {
			const repliesList = document.getElementById('replies-list');
			if (!append && !repliesList.querySelector('.loading')) {
				repliesList.innerHTML = '';
			}
			const loadingEl = repliesList.querySelector('.loading');
			if (loadingEl) loadingEl.remove();
			if (replies.length === 0 && !append) {
				repliesList.innerHTML = '<p class="text-light" style="text-align:center;padding:20px">暂无回复，快来抢沙发～</p>';
				return;
			}
			const fragment = document.createDocumentFragment();
			replies.forEach(reply => {
				const replyEl = document.createElement('div');
				replyEl.className = 'reply-item';
				replyEl.innerHTML = `
            <div class="reply-header">
                <img src="${reply.author.avatar}" class="reply-avatar" referrerpolicy="no-referrer" crossorigin="anonymous">
                <div class="reply-meta">
                    <span class="reply-author ${reply.author.color?.toLowerCase()}">${escapeHtml(reply.author.name)}</span>
                    <span class="reply-time" title="${new Date(reply.time * 1000).toLocaleString('zh-CN')}">${formatRelativeTime(reply.time)}</span>
                </div>
            </div>
            <div class="reply-content markdown-body" data-reply-id="${reply.id}">
                ${renderMarkdown(reply.content)}
            </div>
        `;
				fragment.appendChild(replyEl);
			});
			repliesList.appendChild(fragment);
			replies.forEach(reply => {
				const contentEl = repliesList.querySelector(`[data-reply-id="${reply.id}"]`);
				if (contentEl && /(\$[\s\S]*?\$|\\\(|\\\[)/.test(reply.content)) {
					renderMathInElement(contentEl, {
						delimiters: [
							{ left: '$$', right: '$$', display: true },
							{ left: '$', right: '$', display: false },
							{ left: '\(', right: '\)', display: false },
							{ left: '\[', right: '\]', display: true }
						],
						strict: false,
						escape: false,
						preProcess: (math) => {
							let fixed = math.replace(/\\(\r?\n)/g, '\\\\$1');
							fixed = fixed.replace(/\\(\s*\})/g, '\\\\$1');
							return fixed;
						}
					});
				}
			});
		}
		function handleLoadMoreReplies() {
			if (currentArticleReplies.articleId) {
				loadArticleReplies(
					currentArticleReplies.articleId,
					currentArticleReplies.lastId,
					20,
					true
				);
			}
		}
		async function loadArticle(id, forceRefresh = false) {
			try {
				showPage('article');
				currentType = 'article';
				currentId = id;
				currentArticleReplies = {
					articleId: id,
					lastId: null,
					hasMore: true,
					loading: false,
					high: 0
				};
				const fetchOptions = { cache: 'no-store' };
				const url = `https://luogu-api.amlg.top/article/${id}` + (forceRefresh ? `?r=1` : '');
				const res = await fetch(url, fetchOptions);
				const data = await res.json();
				const article = data.data.data.article;
				currentArticleReplies.count = data.data.data.article.replyCount;
				currentRawContent = article.content || '';
				const rendered = renderMarkdown(currentRawContent);
				const contentEl = document.getElementById('article-content');
				contentEl.innerHTML = rendered;
				const tocEl = generateTOC(contentEl, "article");
				document.getElementById('toc-content').innerHTML = (tocEl ? tocEl : `<a href="#" class="h1">无标题</a>`);
				bindTOCClick();
				const ts = article.time;
				document.getElementById('saveTime').textContent = ts ? `最后保存: ${formatUnixTime(ts)}` : '';
				updateBreadcrumb([
					{ text: '首页', href: '/' },
					{ text: '文章', href: '/a/y81xoxgi' },
					{ text: article.author.name + ' 的《' + (article.title || `文章 #${id}`) + '》' }
				]);
				const repliesSection = document.getElementById('replies-section');
				if (repliesSection) {
					repliesSection.style.display = 'block';
					setTimeout(() => loadArticleReplies(id, null, 10, false), 100);
				}
			} catch (e) {
				showPage('article');
				document.getElementById('article-content').innerHTML = '<p style="color:red">文章加载失败</p>';
			}
		}
		async function loadPaste(id, forceRefresh = false) {
			try {
				showPage('paste');
				currentType = 'paste';
				currentId = id;
				const fetchOptions = { cache: 'no-store' };
				const url = `https://luogu-api.amlg.top/paste/${id}` + (forceRefresh ? `?r=1` : '');
				const res = await fetch(url, fetchOptions);
				const data = await res.json();
				const paste = data.data;
				currentRawContent = data.data.data || '';
				const rendered = renderMarkdown(currentRawContent);
				const contentEl = document.getElementById('paste-content');
				contentEl.innerHTML = rendered;
				const tocEl = generateTOC(contentEl, "paste");
				console.log(tocEl);
				document.getElementById('toc-content-2').innerHTML = (tocEl ? tocEl : `<a href="#" class="h1">无标题</a>`);
				bindTOCClick();
				const ts = paste.time;
				document.getElementById('saveTime-2').textContent = ts ? `最后保存: ${formatUnixTime(ts)}` : '';
				updateBreadcrumb([
					{ text: '首页', href: '/' },
					{ text: '剪贴板', href: '/p/wnvx31ss' },
					{ text: paste.user.name + ` 的剪贴板 #${id}` }
				]);
			} catch (e) {
				showPage('paste');
				document.getElementById('paste-content').innerHTML = '<p style="color:red">剪贴板加载失败</p>';
			}
		}
		function parseRoute() {
			const path = window.location.pathname;
			if (path.startsWith('/a/') || path.startsWith('/article/')) {
				const id = path.split('/')[2];
				if (id) loadArticle(id);
				else showPage('home');
			} else if (path.startsWith('/p/') || path.startsWith('/paste/')) {
				const id = path.split('/')[2];
				if (id) loadPaste(id);
				else showPage('home');
			} else if (path.startsWith('/user/')) {
				const uid = path.split('/')[2];
				if (uid && /^\d+$/.test(uid)) {
					loadUserProfile(uid);
				} else {
					showPage('not-found');
				}
			} else {
				showPage('home');
				updateBreadcrumb([{ text: '首页', href: '/' }]);
			}
		}
		async function loadUserProfile(uid, forceRefresh = false) {
			try {
				showPage('user');
				const fetchOptions = { cache: 'no-store' };
				const url = `https://luogu-api.amlg.top/user/${uid}` + (forceRefresh ? `?r=1` : '');
				const res = await fetch(url, fetchOptions);
				const data = await res.json();
				if (!data.success || !data.data?.data?.user) {
					throw new Error('用户不存在');
				}
				renderUserProfile(data.data.data, uid);
				updateBreadcrumb([
					{ text: '首页', href: '/' },
					{ text: `用户 #${uid}`, href: `/user/${uid}` }
				]);
			} catch (e) {
				console.error('加载用户失败:', e);
				showPage('not-found');
			}
		}
		document.getElementById('goBtn')?.addEventListener('click', () => {
			const input = document.getElementById('urlInput');
			const raw = input.value.trim();
			if (!raw) return;
			let path = raw;
			if (raw.includes('://')) {
				try {
					const url = new URL(raw.startsWith('http') ? raw : 'https://' + raw);
					path = url.pathname;
				} catch (e) {
					alert('无效链接');
					return;
				}
			} else {
				const match = raw.match(/(?:www\.)?luogu\.com\.cn?(\/.*)/i);
				if (match) path = match[1];
				else path = '/' + raw.split('/').slice(1).join('/');
			}
			const articleMatch = path.match(/^\/(?:article|a)\/([^\/\?\#]+)/i);
			const pasteMatch = path.match(/^\/(?:paste|p)\/([^\/\?\#]+)/i);
            const userMatch = path.match(/^\/user\/(\d+)/i);
			if (articleMatch) {
				window.location.pathname = `/a/${articleMatch[1]}`;
			} else if (pasteMatch) {
				window.location.pathname = `/p/${pasteMatch[1]}`;
			} else if (userMatch) {
				window.location.pathname = `/user/${userMatch[1]}`;
			} else {
				alert('未识别到有效的文章、剪贴板或用户 ID');
			}
		});
		document.getElementById('urlInput')?.addEventListener('keypress', (e) => {
			if (e.key === 'Enter') document.getElementById('goBtn').click();
		});
		document.getElementById('article-page')?.addEventListener('click', (e) => {
			if (e.target.closest('#refreshBtn')) { e.preventDefault(); refreshData(); }
			if (e.target.closest('#copyRawBtn')) { e.preventDefault(); copyRawContent(); }
			if (e.target.closest('#jumpOriginalBtn')) { e.preventDefault(); jumpOriginal(); }
		});
		document.getElementById('paste-page')?.addEventListener('click', (e) => {
			if (e.target.closest('#refreshBtn-2')) { e.preventDefault(); refreshData(); }
			if (e.target.closest('#copyRawBtn-2')) { e.preventDefault(); copyRawContent(); }
			if (e.target.closest('#jumpOriginalBtn-2')) { e.preventDefault(); jumpOriginal(); }
		});
		document.addEventListener('DOMContentLoaded', () => {
			parseRoute();
			setTimeout(hideGlobalLoading, 300);
		});
		document.getElementById('load-more-replies')?.addEventListener('click', handleLoadMoreReplies);
		document.getElementById('article-page')?.addEventListener('click', (e) => {
			if (e.target.closest('#refreshBtn')) {
				e.preventDefault();
				currentArticleReplies = { articleId: null, lastId: null, hasMore: true, loading: false };
				document.getElementById('replies-section')?.style.setProperty('display', 'none');
				refreshData();
			}
		});
		window.addEventListener('popstate', parseRoute);
		function formatUnixTime(ts) {
			if (!ts) return '';
			const d = new Date(ts * 1000);
			return d.toLocaleString('zh-CN', { year: 'numeric', month: '2-digit', day: '2-digit', hour: '2-digit', minute: '2-digit' });
		}
		function generateTOC(container, type) {
			const headers = container.querySelectorAll('h1, h2, h3');
			if (headers.length === 0) return '';
			let toc = '';
			headers.forEach((h, i) => {
				const level = h.tagName.toLowerCase();
				const text = h.textContent.trim();
				const id = `toc-${type}-${level}-${i}`;
				h.id = id;
				toc += `<a href="#${id}" class="${level}">${text}</a>`;
			});
			console.log(toc + " 111");
			return (toc ? toc : '<a href="#" class="h1">无标题</a>');
		}
		function bindTOCClick() {
			document.querySelectorAll('.toc-content a').forEach(a => {
				a.addEventListener('click', e => {
					e.preventDefault();
					const target = document.querySelector(a.getAttribute('href'));
					if (target) {
						target.scrollIntoView({ behavior: 'smooth', block: 'start' });
					}
				});
			});
		}
		async function copyRawContent() {
			if (!currentRawContent) return;
			try {
				await navigator.clipboard.writeText(currentRawContent);
				let btn = document.getElementById('copyRawBtn');
				let original = btn.innerHTML;
				btn.innerHTML = '<i class="fa-solid fa-check"></i> 已复制';
				setTimeout(() => btn.innerHTML = original, 1500);
				btn = document.getElementById('copyRawBtn-2');
				original = btn.innerHTML;
				btn.innerHTML = '<i class="fa-solid fa-check"></i> 已复制';
				setTimeout(() => btn.innerHTML = original, 1500);
			} catch (e) {
				alert('复制失败');
			}
		}
		function jumpOriginal() {
			if (!currentType || !currentId) return;
			const url = currentType === 'article'
				? `https://www.luogu.com/article/${currentId}`
				: `https://www.luogu.com/paste/${currentId}`;
			window.open(url, '_blank');
		}
		function goBack() {
			if (window.history.length > 1) window.history.back();
			else {
				window.location.pathname = '/';
				showPage('home');
			}
		}
		async function refreshData() {
			if (!currentType || !currentId) return;
			if (currentType === 'article') await loadArticle(currentId, true);
			else await loadPaste(currentId, true);
		}
		const originalParseRoute = parseRoute;
		parseRoute = function () {
			currentRawContent = '';
			currentType = '';
			currentId = '';
			originalParseRoute();
		}
		function renderUserProfile(userData, uid) {
			const user = userData.user;
			const prizes = userData.prizes || [];
			const eloHistory = userData.elo || [];
			const dailyCounts = userData.dailyCounts || {};
			const gu = userData.gu || {};
			const html = `
        <div class="user-profile">
            <div class="user-header card">
                <div class="user-info" style="background-image: url('${user.background || ''}')">
                    <img src="${user.avatar}" class="user-avatar" referrerpolicy="no-referrer" crossorigin="anonymous">
                    <div class="user-meta">
                        <h2 class="user-name ${user.color?.toLowerCase()}">${escapeHtml(user.name)}</h2>
                        ${user.slogan ? `<p class="user-slogan">${escapeHtml(user.slogan)}</p>` : ''}
                        <div class="user-badges">
                            ${user.ccfLevel ? `<span class="badge ccf-level-${user.ccfLevel}">CCF ${user.ccfLevel}级</span>` : ''}
                        </div>
                    </div>
                </div>
            </div>
            <div class="user-stats card">
                <div class="stat-grid">
                    <div class="stat-item">
                        <span class="stat-value">${user.passedProblemCount ? user.passedProblemCount : '未知'}</span>
                        <span class="stat-label">通过题目</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">${user.submittedProblemCount ? user.submittedProblemCount : '未知'}</span>
                        <span class="stat-label">提交次数</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">${user.followerCount}</span>
                        <span class="stat-label">粉丝</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">${user.followingCount}</span>
                        <span class="stat-label">关注</span>
                    </div>
                    ${gu.rating ? `
                    <div class="stat-item">
                        <span class="stat-value">${gu.rating}</span>
                        <span class="stat-label">排名</span>
                    </div>` : ''}
                    ${eloHistory[0]?.rating ? `
                    <div class="stat-item">
                        <span class="stat-value">${eloHistory[0].rating}</span>
                        <span class="stat-label">等级分</span>
                    </div>` : ''}
                </div>
            </div>
            ${prizes.length > 0 ? `
            <div class="user-prizes card">
                <h3><i class="fa-solid fa-award"></i> 获奖记录</h3>
                <div class="prize-list">
                    ${prizes.map(p => `
                        <div class="prize-item">
                            <span class="prize-year">${p.prize.year}</span>
                            <span class="prize-contest">${escapeHtml(p.prize.contest)}</span>
                            <span class="prize-name">${escapeHtml(p.prize.prize)}</span>
                        </div>
                    `).join('')}
                </div>
            </div>` : ''}
            ${eloHistory.length > 0 ? `
            <div class="user-elo card">
                <h3><i class="fa-solid fa-award"></i> 等级分波动历史</h3>
                <div class="elo-table">
                    <table>
                        <thead>
                            <tr>
                                <th>时间</th>
                                <th>比赛</th>
                                <th>评级</th>
                                <th>变化</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${eloHistory.slice(0, 10).map(e => `
                                <tr>
                                    <td>${formatUnixTime(e.time)}</td>
                                    <td>${escapeHtml(e.contest.name)}</td>
                                    <td>${e.rating}</td>
                                    <td class="${e.prevDiff >= 0 ? 'diff-up' : 'diff-down'}">
                                        ${e.prevDiff != null ? (e.prevDiff >= 0 ? '+' : '') + e.prevDiff : '-'}
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </div>` : ''}
            ${user.introduction ? `
            <div class="user-intro card">
                <h3><i class="fa-solid fa-user-pen"></i> 个人简介</h3>
                <div class="markdown-body" id="user-intro-content">
                </div>
            </div>` : ''}
            <!-- ${Object.keys(dailyCounts).length > 0 ? `
            <div class="user-activity card">
                <h3>近期活动</h3>
                <div class="activity-grid">
                    ${Object.entries(dailyCounts).slice(-30).map(([date, counts]) => `
                        <div class="activity-day" data-date="${date}" title="${date}: ${counts[0]} 提交, ${counts[1]} 通过">
                            <span class="activity-count">${counts[0]}</span>
                        </div>
                    `).join('')}
                </div>
            </div>` : ''} -->
        </div>
    `;
			document.getElementById('user-page').innerHTML = html;
			const introEl = document.getElementById('user-intro-content');
			if (introEl && user.introduction) {
				introEl.innerHTML = renderMarkdown(user.introduction);
			}
		}
	</script>

	<script>
		function showGlobalLoading() {
			document.getElementById('global-loading')?.classList.remove('hidden');
		}
		function hideGlobalLoading() {
			document.getElementById('global-loading')?.classList.add('hidden');
		}
	</script>
</body>

</html>