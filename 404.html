<!doctype html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="icon" type="image/svg+xml" href="https://cdn.luogu.com.cn/upload/image_hosting/oqhxzr7u.png" />
	<title>Amazing Luogu</title>
	<link rel="stylesheet" href="https://cdn.jsdmirror.com/npm/@fortawesome/fontawesome-free@7.2.0/css/all.min.css">
	<link rel="stylesheet" href="https://cdn.jsdmirror.com/npm/lxgw-wenkai-screen-webfont@1.7.0/style.min.css">
	<link rel="stylesheet"
		href="https://cdn.jsdmirror.com/gh/highlightjs/cdn-release@11.8.0/build/styles/atom-one-light.min.css">
	<link rel="stylesheet"
		href="https://cdn.jsdmirror.com/gh/zym2013/amazing-luogu-international@main/style/markdown.css">
	<link rel="stylesheet"
		href="https://cdn.jsdmirror.com/gh/zym2013/amazing-luogu-international@main/style/framework.css">
	<link rel="stylesheet"
		href="https://cdn.jsdmirror.com/gh/zym2013/amazing-luogu-international@main/style/markdown-dark.css">
	<link rel="stylesheet" href="https://cdn.jsdmirror.com/npm/katex@0.16.27/dist/katex.min.css">
	<style>
		.markdown-body {
			font-size: 16px;
			line-height: 1.6;
			color: var(--text-color);
		}

		#goBtn {
			position: absolute;
			right: -29px;
			top: 3px;
			bottom: 4px;
			padding: 0 16px;
			background: var(--primary-color);
			color: white;
			border: none;
			border-radius: var(--border-radius-sm);
			cursor: pointer;
			font-weight: 500;
			transition: background 0.2s;
		}

		#urlInput {
			width: 100%;
			padding: 12px 16px;
			font-size: 1rem;
			border: 1px solid var(--border-color);
			border-radius: var(--border-radius-sm);
			background: var(--card-bg);
			color: var(--text-color);
			box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.05);
			transition: border-color 0.2s;
		}
	</style>
</head>

<body>
	<div id="app">
		<aside class="sidebar" id="sidebar">
			<nav class="nav-menu">
				<a class="nav-logo-item" data-page="none">
					<svg xmlns="http://www.w3.org/2000/svg" width="24" class="nav-icon" height="24" viewBox="0 0 24 24">
						<path fill="currentColor"
							d="M12.424 0c-.435-.005-.964.138-1.569.65c-.967.817-2.554 3.235-3.56 4.38s-2.002 1.65-2.48 2.493c-.477.844-.824 1.598-.385 2.568s2.308 2.592 3.018 3.247s.724.566 1.24.68c.517.113 1.38.188 1.857 0c.478-.19.993-.63 1.006-1.133s-.515-1.409-.928-1.887c-.413-.479-1.213-.769-1.549-.983s-.373-.076-.463-.303s-.413-.59-.078-1.056c.336-.466 1.38-1.033 2.09-1.738s1.625-1.61 2.167-2.492s1.06-2.064 1.085-2.794C13.901.902 13.603.285 13.1.12a2.2 2.2 0 0 0-.676-.12m-.397 6.936c-.243.008-.443.037-.566.097c-.492.24-.48.997-.151 1.515s1.618 1.223 2.124 1.59c.505.366.883.292.908.607c.026.316.102.315-.757 1.287c-.86.973-3.222 3.371-4.397 4.546c-1.175 1.174-1.77 1.503-2.654 2.5S4.259 21.78 3.88 22.563s-.15.997.38 1.212c.531.214 2.11.34 2.804.075c.695-.265.822-1.034 1.365-1.666c.543-.63.721-.859 1.896-2.122c.472-.507 1.242-1.32 1.998-2.118c.048.151.126.324.243.525c.423.727 1.922 2.219 2.537 3.009s.77 1.33 1.154 1.73c.384.402.55.564 1.152.677c.602.112 1.998.188 2.459 0c.461-.189.552-.576.308-1.127c-.243-.552-1.346-1.555-1.768-2.182c-.423-.627-1.243-2.095-1.845-2.71s-1.025-.776-1.768-.977c-.43-.115-.982-.11-1.444-.034c.769-.811 1.564-1.647 2.129-2.246c1.415-1.503 2.88-2.614 3.335-3.56c.455-.948-.214-1.492-.606-2.123c-.391-.631-1.124-1.363-1.743-1.666c-.62-.303-1.151-.1-1.972-.151c-.616-.038-1.737-.197-2.467-.173" />
					</svg>
					<span class="nav-text">Amazing Luogu 国际</span>
				</a>
				<a href="/" class="nav-item" data-page="home">
					<i class="fa-solid fa-house-chimney-user nav-icon"></i>
					<span class="nav-text">首页</span>
				</a>
				<a href="/a/y81xoxgi" class="nav-item" data-page="articles">
					<i class="fa-regular fa-newspaper nav-icon"></i>
					<span class="nav-text">文章</span>
				</a>
				<a href="/p/wnvx31ss" class="nav-item" data-page="clipboard">
					<i class="fa-solid fa-clipboard-list nav-icon"></i>
					<span class="nav-text">剪贴板</span>
				</a>
			</nav>
		</aside>
		<div class="sidebar-overlay" id="sidebarOverlay"></div>
		<div class="main-container">
			<header class="topbar">
				<div class="topbar-left">
					<button class="menu-toggle" id="menuToggle" aria-label="切换菜单">
						<i class="fas fa-bars"></i>
					</button>
					<nav class="breadcrumb" id="breadcrumb"></nav>
				</div>
				<div class="logo">
					<img src="https://cdn.luogu.com.cn/upload/image_hosting/7x00uufg.png" alt="Logo" class="logo-img">
				</div>
			</header>
			<main class="content" id="home-page">
				<div style="text-align: center; max-width: 600px; margin: 0 auto;">
					<div
						style="display: flex; align-items: center; justify-content: center; gap: 16px; margin-bottom: 32px;">
						<h1 style="font-size: 2.5rem; font-weight: 700; color: var(--secondary-color); margin: 0;">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width: 31.57px">
								<path fill="currentColor"
									d="M12.424 0c-.435-.005-.964.138-1.569.65c-.967.817-2.554 3.235-3.56 4.38s-2.002 1.65-2.48 2.493c-.477.844-.824 1.598-.385 2.568s2.308 2.592 3.018 3.247s.724.566 1.24.68c.517.113 1.38.188 1.857 0c.478-.19.993-.63 1.006-1.133s-.515-1.409-.928-1.887c-.413-.479-1.213-.769-1.549-.983s-.373-.076-.463-.303s-.413-.59-.078-1.056c.336-.466 1.38-1.033 2.09-1.738s1.625-1.61 2.167-2.492s1.06-2.064 1.085-2.794C13.901.902 13.603.285 13.1.12a2.2 2.2 0 0 0-.676-.12m-.397 6.936c-.243.008-.443.037-.566.097c-.492.24-.48.997-.151 1.515s1.618 1.223 2.124 1.59c.505.366.883.292.908.607c.026.316.102.315-.757 1.287c-.86.973-3.222 3.371-4.397 4.546c-1.175 1.174-1.77 1.503-2.654 2.5S4.259 21.78 3.88 22.563s-.15.997.38 1.212c.531.214 2.11.34 2.804.075c.695-.265.822-1.034 1.365-1.666c.543-.63.721-.859 1.896-2.122c.472-.507 1.242-1.32 1.998-2.118c.048.151.126.324.243.525c.423.727 1.922 2.219 2.537 3.009s.77 1.33 1.154 1.73c.384.402.55.564 1.152.677c.602.112 1.998.188 2.459 0c.461-.189.552-.576.308-1.127c-.243-.552-1.346-1.555-1.768-2.182c-.423-.627-1.243-2.095-1.845-2.71s-1.025-.776-1.768-.977c-.43-.115-.982-.11-1.444-.034c.769-.811 1.564-1.647 2.129-2.246c1.415-1.503 2.88-2.614 3.335-3.56c.455-.948-.214-1.492-.606-2.123c-.391-.631-1.124-1.363-1.743-1.666c-.62-.303-1.151-.1-1.972-.151c-.616-.038-1.737-.197-2.467-.173" />
							</svg> Amazing Luogu 国际
						</h1>
						<hr>
					</div>
					<p style="color: var(--text-light); margin-bottom: 24px;">请输入任意洛谷文章或剪贴板链接，自动跳转到国际版</p>
					<div style="position: relative;">
						<input type="text" id="urlInput"
							placeholder="例如：https://www.luogu.com.cn/paste/wnvx31ss 或 paste/wnvx31ss/" />
						<button id="goBtn"><i class="fa-solid fa-bolt"></i></button>
					</div>
				</div>
			</main>
			<main class="content" id="article-page" style="display: none;">
				<div class="markdown-body" id="article-content">
					<div class="loading">加载中...</div>
				</div>
			</main>
			<main class="content" id="paste-page" style="display: none;">
				<div class="markdown-body" id="paste-content">
					<div class="loading">加载中...</div>
				</div>
			</main>
		</div>
	</div>
	<script src="https://cdn.jsdmirror.com/gh/zym2013/amazing-luogu-international@main/function/framework.js"></script>
	<script src="https://cdn.jsdmirror.com/npm/marked@4.0.0/marked.min.js"></script>
	<script src="https://cdn.jsdmirror.com/npm/katex@0.16.27/dist/katex.min.js"></script>
	<script src="https://cdn.jsdmirror.com/npm/katex@0.16.27/dist/contrib/auto-render.min.js"></script>
	<script src="https://cdn.jsdmirror.com/gh/highlightjs/cdn-release@11.8.0/build/highlight.min.js"></script>
	<script>
		const customExtensions = [
			{
				name: 'alignBlock',
				level: 'block',
				start(src) { return src.match(/^:::\s*align\s*\{([^}]+)\}/)?.index; },
				tokenizer(src, tokens) {
					const match = src.match(/^:::\s*align\s*\{([^}]+)\}([\s\S]*?)\n:::/);
					if (match) {
						return {
							type: 'alignBlock',
							raw: match[0],
							align: match[1].trim(),
							content: match[2].trim()
						};
					}
				},
				renderer(token) {
					return `<div class="align-${token.align}">${marked.parse(token.content)}</div>`;
				}
			},
			{
				name: 'epigraph',
				level: 'block',
				start(src) { return src.match(/^:::\s*epigraph(\[([^\]]+)\])?\s*:::/)?.index; },
				tokenizer(src, tokens) {
					const match = src.match(/^:::\s*epigraph(\[([^\]]+)\])?\s*([\s\S]*?)\s*:::/);
					if (match) {
						return {
							type: 'epigraph',
							raw: match[0],
							author: match[2] || '',
							content: match[3].trim()
						};
					}
				},
				renderer(token) {
					const authorPart = `<p>${token.author ? token.author : 'unknown author'}</p>`;
					return `<div class="epigraph">${marked.parse(token.content)}${authorPart}</div>`;
				}
			},
			{
				name: 'foldable',
				level: 'block',
				start(src) { return src.match(/^:{3,}/)?.index; },
				tokenizer(src, tokens) {
					const match = src.match(/^(:{3,})\s*(\w+)?(\[([^\]]+)\])?(\s*\{([^}]+)\})?\s*([\s\S]*?)\s*\1/);
					if (match && (match[2] === 'info' || match[2] === 'warning' || match[2] === 'success' || match[2] === 'error' || match[2] === 'bug' || match[2] === 'flask')) {
						return {
							type: 'foldable',
							raw: match[0],
							foldType: match[2] || 'info',
							title: match[4] || '',
							options: match[6] || '',
							content: match[7].trim()
						};
					}
				},
				renderer(token) {
					const isOpen = token.options.includes('open');
					return `
						<details class="foldable ${token.foldType}" ${isOpen ? 'open' : ''}>
							<summary>${token.title || '点击展开'}</summary>
							${marked.parse(token.content)}
						</details>
					`;
				}
			}
		];
		marked.use({ extensions: customExtensions });
		const renderer = new marked.Renderer();
		renderer.code = function (code, language) {
			const lang = language || 'plaintext';
			let highlighted = code;
			if (language && hljs.getLanguage(lang)) {
				try {
					highlighted = hljs.highlight(code, { language: lang, ignoreIllegals: true }).value;
				} catch (e) { }
			}
			return `<div class="code-container"><pre><code class="language-${lang}">${highlighted}</code></pre></div>`;
		};
		marked.setOptions({
			breaks: false,
			gfm: true,
			mangle: false,
			headerIds: false,
			renderer: renderer,
		});
		function renderMarkdown(text) {
			const tmp = document.createElement('div');
			tmp.innerHTML = marked.parse(text);
			renderMathInElement(tmp, {
				delimiters: [
					{ left: '$$', right: '$$', display: true },
					{ left: '$', right: '$', display: false },
					{ left: '\(', right: '\)', display: false },
					{ left: '\[', right: '\]', display: true }
				]
			});
			return tmp.innerHTML;
		}
		function showPage(pageKey) {
			const pages = ['home', 'article', 'paste'];
			pages.forEach(k => {
				const el = document.getElementById(`${k}-page`);
				if (el) el.style.display = 'none';
			});
			const target = document.getElementById(`${pageKey}-page`);
			if (target) target.style.display = 'block';
			document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
			let activePage;
			if (pageKey === 'home') {
				activePage = 'home';
			} else if (pageKey === 'article') {
				activePage = 'articles';
			} else if (pageKey === 'paste') {
				activePage = 'clipboard';
			}
			if (activePage) {
				const activeEl = document.querySelector(`.nav-item[data-page="${activePage}"]`);
				if (activeEl) activeEl.classList.add('active');
			}
		}
		async function loadArticle(id) {
			try {
				showPage('article');
				const res = await fetch(`https://luogu-api.amlg.top/api/a/${id}`);
				const data = await res.json();
				document.getElementById('article-content').innerHTML = renderMarkdown(data.content || '无内容');
				updateBreadcrumb([
					{ text: '首页', href: '/' },
					{ text: '文章', href: '/a/y81xoxgi' },
					{ text: data.author.name + ' 的《' + (data.title || `文章 #${id}`) + '》' }
				]);
			} catch (e) {
				showPage('article');
				document.getElementById('article-content').innerHTML = '<p style="color:red">文章加载失败</p>';
			}
		}
		async function loadPaste(id) {
			try {
				showPage('paste');
				const res = await fetch(`https://luogu-api.amlg.top/api/p/${id}`);
				const data = await res.json();
				document.getElementById('paste-content').innerHTML = renderMarkdown(data.content || '无内容');
				updateBreadcrumb([
					{ text: '首页', href: '/' },
					{ text: '剪贴板', href: '/p/wnvx31ss' },
					{ text: data.author.name + ` 的剪贴板 #${id}` }
				]);
			} catch (e) {
				showPage('paste');
				document.getElementById('paste-content').innerHTML = '<p style="color:red">剪贴板加载失败</p>';
			}
		}
		function parseRoute() {
			const path = window.location.pathname;
			if (path.startsWith('/a/') || path.startsWith('/article/')) {
				const id = path.split('/')[2];
				if (id) loadArticle(id);
				else showPage('home');
			} else if (path.startsWith('/p/') || path.startsWith('/paste/')) {
				const id = path.split('/')[2];
				if (id) loadPaste(id);
				else showPage('home');
			} else {
				showPage('home');
				updateBreadcrumb([{ text: '首页', href: '/' }]);
			}
		}
		document.getElementById('goBtn')?.addEventListener('click', () => {
			const input = document.getElementById('urlInput');
			const raw = input.value.trim();
			if (!raw) return;
			let path = raw;
			if (raw.includes('://')) {
				try {
					const url = new URL(raw.startsWith('http') ? raw : 'https://' + raw);
					path = url.pathname;
				} catch (e) {
					alert('无效链接');
					return;
				}
			} else {
				const match = raw.match(/(?:www\.)?luogu\.com\.cn?(\/.*)/i);
				if (match) path = match[1];
				else path = '/' + raw.split('/').slice(1).join('/');
			}
			const articleMatch = path.match(/^\/(?:article|a)\/([^\/\?\#]+)/i);
			const pasteMatch = path.match(/^\/(?:paste|p)\/([^\/\?\#]+)/i);

			if (articleMatch) {
				window.location.pathname = `/a/${articleMatch[1]}`;
			} else if (pasteMatch) {
				window.location.pathname = `/p/${pasteMatch[1]}`;
			} else {
				alert('未识别到有效的文章或剪贴板 ID');
			}
		});
		document.getElementById('urlInput')?.addEventListener('keypress', (e) => {
			if (e.key === 'Enter') document.getElementById('goBtn').click();
		});
	</script>
</body>

</html>
